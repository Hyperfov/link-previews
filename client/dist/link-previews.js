!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i=e();for(var n in i)("object"==typeof exports?exports:t)[n]=i[n]}}(self,(function(){return(()=>{"use strict";var t={d:(e,i)=>{for(var n in i)t.o(i,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:i[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{LinkPreview:()=>l,linkPreview:()=>o,linkPreviewTemplates:()=>h});const i=t=>{let e=null;if("string"==typeof t){const i=document.querySelector(t);i instanceof HTMLElement?e=i:console.error(`HYPERFOV LINK PREVIEWS >> could not access element ${t}`)}else t instanceof HTMLElement?e=t:console.error("HYPERFOV LINK PREVIEWS >> unknown element type; must be a string or HTMLElement");return e},n=t=>{console.error(`HYPERFOV LINK PREVIEWS >> ${t}`)};class s extends HTMLElement{static get observedAttributes(){return["parent","open","template","position","url","title","description","img","fetch","backend"]}constructor(){super(),this._shadow=this.attachShadow({mode:"open"}),this.render=this.render.bind(this),this.retrievePage=this.retrievePage.bind(this),this.getAttrOrDefault=this.getAttrOrDefault.bind(this),this.url=this.getAttrOrDefault("url",null),this.t=this.getAttrOrDefault("title",null),this.description=this.getAttrOrDefault("description",null),this.img=this.getAttrOrDefault("img",null),this.fetch=this.getAttrOrDefault("fetch",!0,(t=>"true"===t)),this.open=this.getAttrOrDefault("open",!1,(t=>"true"===t)),this.parentPos=this.getAttrOrDefault("parent",null,(t=>JSON.parse(t))),this.backend=this.getAttrOrDefault("backend",null),this.template=this.getAttrOrDefault("template",null),this.position=this.getAttrOrDefault("position",null),this.retrievedPage=!1,this.templateElt=null,this.render()}attributeChangedCallback(t){"parent"===t?this.parentPos=this.getAttrOrDefault(t,null,(t=>JSON.parse(t))):"open"===t?this.open=this.getAttrOrDefault(t,!1,(t=>"true"===t)):"fetch"===t?this.fetch=this.getAttrOrDefault(t,!0,(t=>"true"===t)):"title"===t?this.t=this.getAttrOrDefault(t,null):this[t]=this.getAttrOrDefault(t,null),this.render()}render(){if(this.parentPos&&this.open){!this.retrievedPage&&this.fetch&&this.backend&&this.retrievePage(),this.template&&!this.templateElt&&(this.templateElt=i(this.template)?.content,this._shadow.appendChild(this.templateElt.cloneNode(!0))),this.style.position="absolute",this.style.pointerEvents="none";const t=this.getBoundingClientRect(),e=this.parentPos.y-t.height<0,n=this.parentPos.bottom+t.height>window.innerHeight;"below"===this.position&&!n||"above"===this.position&&e?(this.style.left=`${this.parentPos.x}px`,this.style.top=`${this.parentPos.bottom+window.scrollY}px`):"above"===this.position&&!e||"below"===this.position&&n?(this.style.left=`${this.parentPos.x}px`,this.style.top=`${this.parentPos.y-t.height+window.scrollY}px`):"follow"===this.position&&(this.style.left=`${this.parentPos.x}px`,this.style.top=`${this.parentPos.y+window.scrollY+15}px`),this.style.transition="0.2s opacity ease-in",this.style.opacity=1,this.description&&!this.descriptionElt?(this.descriptionElt=document.createElement("span"),this.descriptionElt.id="description",this.descriptionElt.setAttribute("slot","description"),this.descriptionElt.textContent=this.description,this.appendChild(this.descriptionElt),this._shadow.querySelector("div")?.classList.add("has-description")):this.descriptionElt&&this.description!==this.descriptionElt.textContent&&(this.descriptionElt.textContent=this.description),this.t&&!this.titleElt?(this.titleElt=document.createElement("span"),this.titleElt.id="title",this.titleElt.setAttribute("slot","title"),this.titleElt.textContent=this.t,this.appendChild(this.titleElt),this._shadow.querySelector("div")?.classList.add("has-title")):this.titleElt&&this.t!==this.titleElt.textContent&&(this.titleElt.textContent=this.t),this.url&&!this.urlElt?(this.urlElt=document.createElement("span"),this.urlElt.id="url",this.urlElt.setAttribute("slot","url"),this.urlElt.textContent=this.url,this.appendChild(this.urlElt),this._shadow.querySelector("div")?.classList.add("has-url")):this.urlElt&&this.url!==this.urlElt.textContent&&(this.urlElt.textContent=this.url),this.img&&!this.imgElt?(this.imgElt=document.createElement("img"),this.imgElt.id="img",this.imgElt.setAttribute("slot","image"),this.imgElt.src=this.img,this.appendChild(this.imgElt),this._shadow.querySelector("div")?.classList.add("has-image")):this.imgElt&&this.img!==this.imgElt.src&&(this.imgElt.src=this.img)}else this.parentPos&&!this.open&&(this.style.opacity=0)}retrievePage(){this.retrievedPage=!0,fetch(`${this.backend}/?page=${this.url}`).then((t=>{t.ok&&t.json().then((t=>{t.title&&!this.t&&(this.t=t.title),t.description&&!this.description&&(this.description=t.description),t.image&&!this.img&&(this.img=t.image),this.render()}))}))}getAttrOrDefault(t,e,i=(t=>t)){if(this.hasAttribute(t))try{return i(this.getAttribute(t))}catch{n(`could not parse attribute "${t}" with value ${val}`)}return e}}const l=s,r=()=>'\n  <template id="hyperfov-link-preview-template">\n  <style>\n    .link-popup-wrapper {\n      padding: 10px;\n      background-color: white;\n      box-shadow: 0px 0px 20px rgba(122, 122, 122, 0.63);\n      border-radius: 6px;\n      max-width: 275px;\n    }\n\n    .link-interior-content div:not(:first-child) {\n      margin-top: 5px;\n    }\n\n    .has-image .link-url,\n    .has-title .link-url,\n    .has-description .link-url,\n    .has-title .link-url {\n      margin-top: 10px;\n    }\n\n    .link-url {\n      text-overflow: ellipsis;\n      overflow: hidden;\n      white-space: nowrap;\n    }\n\n    .link-image {\n      flex-shrink: 0;\n    }\n\n    .link-title {\n      font-weight: bold;\n    }\n\n    ::slotted(img) {\n      max-width: 100%;\n      border-radius: 3px;\n      width: 100%;\n      height: auto;\n      object-fit: cover;\n      object-position: center center;\n    }\n  </style>\n  <div class="link-popup-wrapper">\n    <div class="link-interior-content">\n      <div class="link-image"><slot name="image"></slot></div>\n      <div class="link-title"><slot name="title"></slot></div>\n      <div class="link-description">\n        <slot name="description"></slot>\n      </div>\n    </div>\n    <div class="link-url"><slot name="url"></slot></div>\n  </div>\n</template>';function o(t,e={}){const s={title:null,description:null,img:null,url:null,backend:null,fetchLink:!0,position:"below",template:"#hyperfov-link-preview-template",...e};!s.backend&&s.fetchLink&&n("missing backend url");let l=i(t);e.template?"basic"===e.template&&(document.body.insertAdjacentHTML("afterbegin",'\n  <template id="hyperfov-link-preview-template">\n  <style>\n    .link-popup-wrapper {\n      padding: 10px;\n      background-color: white;\n      box-shadow: 0px 0px 20px rgba(122, 122, 122, 0.63);\n      border-radius: 6px;\n      max-width: 275px;\n    }\n\n    .link-interior-content div:not(:first-child) {\n      margin-top: 5px;\n    }\n\n    .has-image .link-url,\n    .has-title .link-url,\n    .has-description .link-url,\n    .has-title .link-url {\n      margin-top: 10px;\n    }\n\n    .link-url {\n      text-overflow: ellipsis;\n      overflow: hidden;\n      white-space: nowrap;\n    }\n\n    .link-image {\n      flex-shrink: 0;\n    }\n\n    .link-title {\n      font-weight: bold;\n    }\n\n    ::slotted(img) {\n      max-width: 100%;\n      border-radius: 3px;\n      width: 100%;\n      height: auto;\n      object-fit: cover;\n      object-position: center center;\n    }\n  </style>\n  <div class="link-popup-wrapper">\n    <div class="link-interior-content">\n      <div class="link-image"><slot name="image"></slot></div>\n      <div class="link-title"><slot name="title"></slot></div>\n      <div class="link-description">\n        <slot name="description"></slot>\n      </div>\n    </div>\n    <div class="link-url"><slot name="url"></slot></div>\n  </div>\n</template>'),s.template="#hyperfov-link-preview-template"):document.querySelector(s.template)instanceof HTMLElement||n("missing template");const r=document.createElement("link-preview");r.setAttribute("position",s.position),s.url?r.setAttribute("url",s.url):r.setAttribute("url",l.href),s.template&&r.setAttribute("template",s.template),s.description&&r.setAttribute("description",s.description),s.img&&r.setAttribute("img",s.img),s.title&&r.setAttribute("title",s.title),s.backend&&r.setAttribute("backend",s.backend),document.body.appendChild(r),l.addEventListener("mouseover",(()=>{const t=l.getBoundingClientRect();r.setAttribute("parent",JSON.stringify(t)),r.setAttribute("open","true")})),l.addEventListener("mouseout",(()=>{r.setAttribute("open",!1)})),"follow"===s.position&&l.addEventListener("mousemove",(t=>{const e={x:t.clientX,y:t.clientY};r.setAttribute("parent",JSON.stringify(e))}))}customElements.define("link-preview",l),console.log("HYPERFOV LINK PREVIEWS >> running");const h={basicTemplate:r};return window.linkPreview=o,e})()}));